const fs = require('fs');
const mongoose = require('mongoose');
const dotenv = require('dotenv');
const User = require('./models/User');
const Category = require('./models/Category');
const Product = require('./models/Product');
const Order = require('./models/Order');
const SystemConfig = require('./models/SystemConfig');

// Cargar variables de entorno
dotenv.config();

// Conectar a la base de datos
mongoose.connect(process.env.MONGO_URI, {
  useNewUrlParser: true,
  useUnifiedTopology: true
});

// =====================================================
// üìã USUARIOS DEMOSTRATIVOS (1 de cada tipo)
// =====================================================
const users = [
  // üîß ADMINISTRADOR
  {
    "_id": "663f1a2b8c9d123456789001",
    "name": "Admin AutoParts",
    "email": "admin@autoparts.com",
    "password": "contrase√±a123", // password123
    "role": "admin",
    "address": {
      "street": "Av. Libertador Bernardo O'Higgins 1234",
      "city": "Santiago",
      "state": "Regi√≥n Metropolitana",
      "postalCode": "8320000",
      "country": "Chile"
    },
    "phone": "+56 9 8765 4321",
    "createdAt": "2025-04-15T10:30:00.000Z"
  },
  // üë§ CLIENTE REGULAR
  {
    "_id": "663f1a2b8c9d123456789002",
    "name": "Carlos Mendoza",
    "email": "pa.hernandezu@duocuc.cl",
    "password": "contrase√±a123", // password123
    "role": "client",
    "address": {
      "street": "Calle Las Flores 567",
      "city": "Santiago",
      "state": "Regi√≥n Metropolitana",
      "postalCode": "7500000",
      "country": "Chile"
    },
    "phone": "+56 9 1234 5678",
    "createdAt": "2025-04-18T14:15:00.000Z"
  },
  // üè¢ DISTRIBUIDOR APROBADO
  {
    "_id": "663f1a2b8c9d123456789003",
    "name": "Repuestos Central SpA",
    "email": "pa.hernandezu@duoocuc.cl",
    "password": "contrase√±a123", // password123
    "role": "distributor",
    "address": {
      "street": "Av. Industrial 2500",
      "city": "Santiago",
      "state": "Regi√≥n Metropolitana",
      "postalCode": "8320000",
      "country": "Chile"
    },
    "phone": "+56 2 2890 4567",
    "distributorInfo": {
      "companyName": "Repuestos Central SpA",
      "companyRUT": "76.543.210-9",
      "businessLicense": "RES-2025-001",
      "creditLimit": 5000000,
      "discountPercentage": 18,
      "isApproved": true,
      "approvedBy": "663f1a2b8c9d123456789001",
      "approvedAt": "2025-04-20T09:00:00.000Z"
    },
    "createdAt": "2025-04-19T16:45:00.000Z"
  },
  // üè¢ DISTRIBUIDOR PENDIENTE
  {
    "_id": "663f1a2b8c9d123456789004",
    "name": "AutoServicios del Norte Ltda",
    "email": "gerencia@autoserviciosnorte.cl",
    "password": "contrase√±a123", // password123
    "role": "distributor",
    "address": {
      "street": "Calle Atacama 1890",
      "city": "Antofagasta",
      "state": "Regi√≥n de Antofagasta",
      "postalCode": "1240000",
      "country": "Chile"
    },
    "phone": "+56 55 234 5678",
    "distributorInfo": {
      "companyName": "AutoServicios del Norte Ltda",
      "companyRUT": "87.654.321-0",
      "businessLicense": "RES-2025-002",
      "creditLimit": 0,
      "discountPercentage": 0,
      "isApproved": false // üîÑ PENDIENTE DE APROBACI√ìN
    },
    "createdAt": "2025-05-10T11:20:00.000Z"
  }
];

// =====================================================
// üìÇ CATEGOR√çAS REPRESENTATIVAS
// =====================================================
const categories = [
  {
    "_id": "663f1a2b8c9d123456780001",
    "name": "Motor",
    "description": "Componentes internos y externos del motor",
    "slug": "motor",
    "createdAt": "2025-04-10T08:00:00.000Z"
  },
  {
    "_id": "663f1a2b8c9d123456780002",
    "name": "Sistema de Frenos",
    "description": "Pastillas, discos, l√≠quidos y componentes de frenado",
    "slug": "sistema_de_frenos",
    "createdAt": "2025-04-10T08:15:00.000Z"
  },
  {
    "_id": "663f1a2b8c9d123456780003",
    "name": "Suspensi√≥n y Direcci√≥n",
    "description": "Amortiguadores, muelles y sistema de direcci√≥n",
    "slug": "suspension_y_direccion",
    "createdAt": "2025-04-10T08:30:00.000Z"
  },
  {
    "_id": "663f1a2b8c9d123456780004",
    "name": "Sistema El√©ctrico",
    "description": "Bater√≠as, alternadores, cableado y componentes el√©ctricos",
    "slug": "sistema_electrico",
    "createdAt": "2025-04-10T08:45:00.000Z"
  },
  {
    "_id": "663f1a2b8c9d123456780005",
    "name": "Transmisi√≥n",
    "description": "Embragues, cajas de cambio y transmisi√≥n",
    "slug": "transmision",
    "createdAt": "2025-04-10T09:00:00.000Z"
  },
  {
    "_id": "663f1a2b8c9d123456780006",
    "name": "Neum√°ticos y Llantas",
    "description": "Neum√°ticos, llantas y accesorios de ruedas",
    "slug": "neumaticos_y_llantas",
    "createdAt": "2025-04-10T09:15:00.000Z"
  }
];

// =====================================================
// üõí PRODUCTOS DEMOSTRATIVOS (Todas las funcionalidades)
// =====================================================
const products = [
  // üî• PRODUCTO EN SUPER OFERTA (Destacado + Descuento)
  {
    "_id": "663f1a2b8c9d123456770001",
    "name": "Kit de Pastillas de Freno Premium Brembo",
    "description": "Kit completo de pastillas de freno delanteras de la marca Brembo. Incluye pastillas cer√°micas de alto rendimiento, clips de montaje y grasa para gu√≠as. Compatible con veh√≠culos europeos de alta gama.",
    "price": 89990,
    "wholesalePrice": 67990,
    "stockQuantity": 25,
    "category": "663f1a2b8c9d123456780002",
    "brand": "Brembo",
    "sku": "BRE-KIT-001",
    "partNumber": "P85020",
    "compatibleModels": [
      { "make": "BMW", "model": "Serie 3", "year": 2020 },
      { "make": "Mercedes-Benz", "model": "Clase C", "year": 2019 },
      { "make": "Audi", "model": "A4", "year": 2021 }
    ],
    "featured": true, // ‚≠ê PRODUCTO DESTACADO
    "onSale": true, // üî• EN OFERTA
    "discountPercentage": 25, // 25% descuento
    "salePrice": 67493,
    "saleEndDate": "2025-06-15T23:59:59.000Z",
    "avgRating": 4.8,
    "ratings": [
      {
        "user": "663f1a2b8c9d123456789002",
        "rating": 5,
        "comment": "Excelente calidad, se nota la diferencia en el frenado",
        "userName": "Carlos M.",
        "date": "2025-05-15T14:30:00.000Z"
      }
    ],
    "createdAt": "2025-04-12T10:00:00.000Z",
    "slug": "kit_pastillas_freno_premium_brembo"
  },
  
  // üÜï PRODUCTO NUEVO SIN DESCUENTO (Alto stock)
  {
    "_id": "663f1a2b8c9d123456770002",
    "name": "Filtro de Aceite Mahle Original",
    "description": "Filtro de aceite original Mahle para motores de 4 cilindros. Filtraci√≥n superior que protege el motor y prolonga la vida √∫til del aceite. Incluye junta de goma nueva.",
    "price": 12990,
    "wholesalePrice": 9990,
    "stockQuantity": 150,
    "category": "663f1a2b8c9d123456780001",
    "brand": "Mahle",
    "sku": "MAH-FIL-002",
    "partNumber": "OC 90",
    "compatibleModels": [
      { "make": "Toyota", "model": "Corolla", "year": 2022 },
      { "make": "Honda", "model": "Civic", "year": 2021 },
      { "make": "Nissan", "model": "Sentra", "year": 2023 }
    ],
    "featured": false,
    "onSale": false,
    "discountPercentage": 0,
    "avgRating": 4.5,
    "createdAt": "2025-05-01T09:30:00.000Z",
    "slug": "filtro_aceite_mahle_original"
  },
  
  // ‚ö° PRODUCTO EN DESCUENTO MODERADO (Stock medio)
  {
    "_id": "663f1a2b8c9d123456770003",
    "name": "Amortiguador Trasero Monroe",
    "description": "Amortiguador trasero Monroe Gas-Matic para m√°ximo confort y control. Tecnolog√≠a de v√°lvula de precisi√≥n que proporciona una conducci√≥n suave en todo tipo de terrenos.",
    "price": 65990,
    "wholesalePrice": 52990,
    "stockQuantity": 45,
    "category": "663f1a2b8c9d123456780003",
    "brand": "Monroe",
    "sku": "MON-AMO-003",
    "partNumber": "G7240",
    "compatibleModels": [
      { "make": "Chevrolet", "model": "Cruze", "year": 2020 },
      { "make": "Ford", "model": "Focus", "year": 2019 }
    ],
    "featured": true,
    "onSale": true,
    "discountPercentage": 15, // 15% descuento
    "salePrice": 56092,
    "avgRating": 4.3,
    "createdAt": "2025-04-25T11:15:00.000Z",
    "slug": "amortiguador_trasero_monroe"
  },
  
  // ‚ö†Ô∏è PRODUCTO CON STOCK BAJO
  {
    "_id": "663f1a2b8c9d123456770004",
    "name": "Alternador Bosch 12V 90A",
    "description": "Alternador Bosch de 12V y 90A de potencia. Reconstruido con componentes originales, incluye garant√≠a de 1 a√±o. Ideal para veh√≠culos de alta demanda el√©ctrica.",
    "price": 125990,
    "wholesalePrice": 99990,
    "stockQuantity": 3, // ‚ö†Ô∏è STOCK BAJO
    "category": "663f1a2b8c9d123456780004",
    "brand": "Bosch",
    "sku": "BOS-ALT-004",
    "partNumber": "0 986 045 340",
    "compatibleModels": [
      { "make": "Volkswagen", "model": "Golf", "year": 2018 },
      { "make": "Seat", "model": "Leon", "year": 2019 }
    ],
    "featured": false,
    "onSale": false,
    "discountPercentage": 0,
    "avgRating": 4.6,
    "createdAt": "2025-04-20T13:45:00.000Z",
    "slug": "alternador_bosch_12v_90a"
  },
  
  // üö´ PRODUCTO AGOTADO
  {
    "_id": "663f1a2b8c9d123456770005",
    "name": "Kit de Embrague LuK RepSet",
    "description": "Kit completo de embrague LuK RepSet incluye disco, plato de presi√≥n y rodamiento de embrague. Para transmisiones manuales de veh√≠culos medianos.",
    "price": 185990,
    "wholesalePrice": 148990,
    "stockQuantity": 0, // üö´ AGOTADO
    "category": "663f1a2b8c9d123456780005",
    "brand": "LuK",
    "sku": "LUK-EMB-005",
    "partNumber": "623 3042 00",
    "compatibleModels": [
      { "make": "Hyundai", "model": "Elantra", "year": 2020 },
      { "make": "Kia", "model": "Cerato", "year": 2021 }
    ],
    "featured": false,
    "onSale": false,
    "discountPercentage": 0,
    "avgRating": 4.7,
    "createdAt": "2025-04-18T16:20:00.000Z",
    "slug": "kit_embrague_luk_repset"
  },
  
  // üîã PRODUCTO DE CATEGOR√çA EL√âCTRICA (Con valoraciones)
  {
    "_id": "663f1a2b8c9d123456770006",
    "name": "Bater√≠a Varta Blue Dynamic 60Ah",
    "description": "Bater√≠a de arranque Varta Blue Dynamic de 60Ah. Tecnolog√≠a libre de mantenimiento con excelente rendimiento en fr√≠o. 3 a√±os de garant√≠a.",
    "price": 89990,
    "wholesalePrice": 71990,
    "stockQuantity": 35,
    "category": "663f1a2b8c9d123456780004",
    "brand": "Varta",
    "sku": "VAR-BAT-006",
    "partNumber": "C22",
    "compatibleModels": [
      { "make": "Peugeot", "model": "208", "year": 2022 },
      { "make": "Citro√´n", "model": "C3", "year": 2021 }
    ],
    "featured": true,
    "onSale": false,
    "discountPercentage": 0,
    "avgRating": 4.4,
    "ratings": [
      {
        "user": "663f1a2b8c9d123456789002",
        "rating": 4,
        "comment": "Buena bater√≠a, arranca bien en invierno",
        "userName": "Carlos M.",
        "date": "2025-05-12T10:15:00.000Z"
      }
    ],
    "createdAt": "2025-04-28T09:00:00.000Z",
    "slug": "bateria_varta_blue_dynamic_60ah"
  },
  
  // Productos de relleno (m√°s simples)
  {
    "_id": "663f1a2b8c9d123456770007",
    "name": "Neum√°tico Michelin Primacy 4",
    "description": "Neum√°tico Michelin Primacy 4 medida 205/55R16. Excelente agarre en mojado y seco.",
    "price": 75990,
    "wholesalePrice": 60990,
    "stockQuantity": 60,
    "category": "663f1a2b8c9d123456780006",
    "brand": "Michelin",
    "sku": "MIC-NEU-007",
    "partNumber": "223647",
    "featured": false,
    "onSale": false,
    "discountPercentage": 0,
    "avgRating": 4.2,
    "createdAt": "2025-05-03T14:00:00.000Z",
    "slug": "neumatico_michelin_primacy_4"
  },
  
  {
    "_id": "663f1a2b8c9d123456770008",
    "name": "Radiador Valeo",
    "description": "Radiador de aluminio Valeo para sistema de refrigeraci√≥n. Excelente transferencia de calor.",
    "price": 95990,
    "wholesalePrice": 76990,
    "stockQuantity": 20,
    "category": "663f1a2b8c9d123456780001",
    "brand": "Valeo",
    "sku": "VAL-RAD-008",
    "partNumber": "732972",
    "featured": false,
    "onSale": true,
    "discountPercentage": 10,
    "salePrice": 86391,
    "avgRating": 4.1,
    "createdAt": "2025-04-30T12:30:00.000Z",
    "slug": "radiador_valeo"
  },
  
  {
    "_id": "663f1a2b8c9d123456770009",
    "name": "Buj√≠as NGK Iridium",
    "description": "Juego de 4 buj√≠as NGK con electrodo de iridio. Mayor duraci√≥n y mejor encendido.",
    "price": 35990,
    "wholesalePrice": 28990,
    "stockQuantity": 80,
    "category": "663f1a2b8c9d123456780001",
    "brand": "NGK",
    "sku": "NGK-BUJ-009",
    "partNumber": "ILZFR6D11",
    "featured": false,
    "onSale": false,
    "discountPercentage": 0,
    "avgRating": 4.6,
    "createdAt": "2025-05-05T15:45:00.000Z",
    "slug": "bujias_ngk_iridium"
  },
  
  {
    "_id": "663f1a2b8c9d123456770010",
    "name": "Llanta de Aleaci√≥n 17\"",
    "description": "Llanta de aleaci√≥n deportiva de 17 pulgadas. Dise√±o moderno y peso reducido.",
    "price": 120990,
    "wholesalePrice": 96990,
    "stockQuantity": 24,
    "category": "663f1a2b8c9d123456780006",
    "brand": "OZ Racing",
    "sku": "OZR-LLA-010",
    "partNumber": "W0425320154",
    "featured": true,
    "onSale": false,
    "discountPercentage": 0,
    "avgRating": 4.5,
    "createdAt": "2025-05-08T11:00:00.000Z",
    "slug": "llanta_aleacion_17"
  }
];

// =====================================================
// üìã √ìRDENES DEMOSTRATIVAS (Diferentes estados)
// =====================================================
const orders = [
  // üõí ORDEN COMPLETADA B2C (Cliente regular)
  {
    "_id": "663f1a2b8c9d123456760001",
    "user": "663f1a2b8c9d123456789002",
    "items": [
      {
        "product": "663f1a2b8c9d123456770002",
        "quantity": 2,
        "price": 12990
      },
      {
        "product": "663f1a2b8c9d123456770009",
        "quantity": 1,
        "price": 35990
      }
    ],
    "shipmentMethod": "delivery",
    "shippingAddress": {
      "street": "Calle Las Flores 567",
      "city": "Santiago",
      "state": "Regi√≥n Metropolitana",
      "postalCode": "7500000",
      "country": "Chile"
    },
    "paymentMethod": "webpay",
    "itemsPrice": 61970,
    "taxPrice": 11774,
    "shippingPrice": 5000,
    "totalPrice": 78744,
    "orderType": "B2C",
    "taxRate": 19,
    "isPaid": true,
    "paidAt": "2025-05-14T10:30:00.000Z",
    "isDelivered": true,
    "deliveredAt": "2025-05-16T14:20:00.000Z",
    "status": "delivered",
    "paymentResult": {
      "id": "token_ws_123456",
      "buyOrder": "ORDER_001_1715693400",
      "authorizationCode": "123456",
      "status": "approved",
      "paymentMethod": "webpay"
    },
    "createdAt": "2025-05-14T09:15:00.000Z"
  },
  
  // üè¢ ORDEN B2B PENDIENTE (Distribuidor)
  {
    "_id": "663f1a2b8c9d123456760002",
    "user": "663f1a2b8c9d123456789003",
    "items": [
      {
        "product": "663f1a2b8c9d123456770001",
        "quantity": 5,
        "price": 67990 // Precio mayorista
      },
      {
        "product": "663f1a2b8c9d123456770006",
        "quantity": 3,
        "price": 71990 // Precio mayorista
      }
    ],
    "shipmentMethod": "pickup",
    "pickupLocation": {
      "name": "AutoParts Bodega Central",
      "address": "Av. Industrial 1500, Santiago",
      "scheduledDate": "2025-05-22T10:00:00.000Z"
    },
    "paymentMethod": "bankTransfer",
    "itemsPrice": 555920,
    "taxPrice": 105625,
    "shippingPrice": 0,
    "totalPrice": 661545,
    "orderType": "B2B",
    "taxRate": 19,
    "isPaid": false,
    "isDelivered": false,
    "status": "processing",
    "createdAt": "2025-05-18T16:45:00.000Z"
  }
];

// =====================================================
// ‚öôÔ∏è CONFIGURACIONES DEL SISTEMA
// =====================================================
const systemConfigs = [
  {
    key: 'tax_rate',
    value: 19,
    description: 'Porcentaje de IVA aplicado a las ventas',
    type: 'number',
    category: 'tax',
    validationRules: { min: 0, max: 100 },
    lastModifiedBy: "663f1a2b8c9d123456789001",
    createdAt: "2025-04-15T10:30:00.000Z"
  },
  {
    key: 'free_shipping_threshold',
    value: 80000,
    description: 'Monto m√≠nimo para env√≠o gratuito (CLP)',
    type: 'number',
    category: 'shipping',
    validationRules: { min: 0 },
    lastModifiedBy: "663f1a2b8c9d123456789001",
    createdAt: "2025-04-15T10:30:00.000Z"
  },
  {
    key: 'default_shipping_cost',
    value: 5000,
    description: 'Costo de env√≠o por defecto (CLP)',
    type: 'number',
    category: 'shipping',
    validationRules: { min: 0 },
    lastModifiedBy: "663f1a2b8c9d123456789001",
    createdAt: "2025-04-15T10:30:00.000Z"
  },
  {
    key: 'site_name',
    value: 'AutoParts',
    description: 'Nombre del sitio web',
    type: 'string',
    category: 'general',
    lastModifiedBy: "663f1a2b8c9d123456789001",
    createdAt: "2025-04-15T10:30:00.000Z"
  },
  {
    key: 'contact_email',
    value: 'info@autoparts.com',
    description: 'Email de contacto principal',
    type: 'string',
    category: 'general',
    lastModifiedBy: "663f1a2b8c9d123456789001",
    createdAt: "2025-04-15T10:30:00.000Z"
  },
  {
    key: 'enable_b2b',
    value: true,
    description: 'Habilitar funcionalidades B2B (mayorista)',
    type: 'boolean',
    category: 'general',
    isEditable: true,
    lastModifiedBy: "663f1a2b8c9d123456789001",
    createdAt: "2025-04-15T10:30:00.000Z"
  },
  {
    key: 'webpay_environment',
    value: 'integration',
    description: 'Entorno de Webpay (integration/production)',
    type: 'string',
    category: 'payment',
    validationRules: { enum: ['integration', 'production'] },
    isEditable: true,
    lastModifiedBy: "663f1a2b8c9d123456789001",
    createdAt: "2025-04-15T10:30:00.000Z"
  },
  {
    key: 'low_stock_threshold',
    value: 5,
    description: 'Umbral de stock bajo para alertas',
    type: 'number',
    category: 'inventory',
    validationRules: { min: 1, max: 50 },
    isEditable: true,
    lastModifiedBy: "663f1a2b8c9d123456789001",
    createdAt: "2025-04-15T10:30:00.000Z"
  }
];

// =====================================================
// üìä FUNCIONES DE IMPORTACI√ìN Y ELIMINACI√ìN
// =====================================================

// Funci√≥n para importar datos
const importData = async () => {
  try {
    console.log('üöÄ Iniciando importaci√≥n de datos AutoParts...');
    console.log('üìÖ Datos de ejemplo con fechas abril-mayo 2025\n');

    // Importar usuarios
    console.log('üë• Importando usuarios...');
    await User.create(users);
    console.log(`‚úÖ ${users.length} usuarios importados:`);
    console.log('   üîß 1 Administrador');
    console.log('   üë§ 1 Cliente regular');
    console.log('   üè¢ 1 Distribuidor aprobado');
    console.log('   ‚è≥ 1 Distribuidor pendiente\n');

    // Importar categor√≠as
    console.log('üìÇ Importando categor√≠as...');
    await Category.create(categories);
    console.log(`‚úÖ ${categories.length} categor√≠as importadas\n`);

    // Importar productos
    console.log('üõí Importando productos...');
    await Product.create(products);
    console.log(`‚úÖ ${products.length} productos importados:`);
    console.log('   üî• 1 Producto en super oferta (25% desc)');
    console.log('   ‚ö° 1 Producto en descuento moderado (15% desc)');
    console.log('   üÜï Productos nuevos sin descuento');
    console.log('   ‚ö†Ô∏è 1 Producto con stock bajo');
    console.log('   üö´ 1 Producto agotado');
    console.log('   ‚≠ê Productos destacados');
    console.log('   üí¨ Productos con valoraciones\n');

    // Importar √≥rdenes
    console.log('üìã Importando √≥rdenes...');
    await Order.create(orders);
    console.log(`‚úÖ ${orders.length} √≥rdenes importadas:`);
    console.log('   ‚úÖ 1 Orden B2C completada (delivery)');
    console.log('   üè¢ 1 Orden B2B en proceso (pickup)\n');

    // Importar configuraciones del sistema
    console.log('‚öôÔ∏è Importando configuraciones del sistema...');
    for (const config of systemConfigs) {
      try {
        await SystemConfig.create(config);
        console.log(`   ‚úÖ ${config.key}: ${config.value}`);
      } catch (err) {
        if (err.code === 11000) {
          console.log(`   ‚ö†Ô∏è Ya existe: ${config.key}`);
        } else {
          console.error(`   ‚ùå Error: ${config.key} - ${err.message}`);
        }
      }
    }

    console.log('\nüéâ ¬°Importaci√≥n completada exitosamente!');
    console.log('\nüìä RESUMEN DE FUNCIONALIDADES INCLUIDAS:');
    console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
    console.log('üîê AUTENTICACI√ìN:');
    console.log('   ‚Ä¢ Admin, Cliente, Distribuidor aprobado/pendiente');
    console.log('\nüõí PRODUCTOS:');
    console.log('   ‚Ä¢ Productos en oferta con descuentos');
    console.log('   ‚Ä¢ Productos destacados');
    console.log('   ‚Ä¢ Stock bajo y agotados');
    console.log('   ‚Ä¢ Precios B2B y B2C');
    console.log('   ‚Ä¢ Valoraciones y comentarios');
    console.log('\nüì¶ √ìRDENES:');
    console.log('   ‚Ä¢ Orden B2C completada con Webpay');
    console.log('   ‚Ä¢ Orden B2B mayorista en proceso');
    console.log('   ‚Ä¢ Diferentes m√©todos de pago y env√≠o');
    console.log('\nüè¢ FUNCIONALIDADES B2B:');
    console.log('   ‚Ä¢ Distribuidor aprobado con descuentos');
    console.log('   ‚Ä¢ Distribuidor pendiente de aprobaci√≥n');
    console.log('   ‚Ä¢ Precios mayoristas diferenciados');
    console.log('\n‚öôÔ∏è CONFIGURACIONES:');
    console.log('   ‚Ä¢ IVA, env√≠o gratuito, costos');
    console.log('   ‚Ä¢ Configuraci√≥n Webpay');
    console.log('   ‚Ä¢ Alertas de stock bajo');
    console.log('\nüéØ DATOS DE ACCESO:');
    console.log('   üìß Admin: admin@autoparts.com');
    console.log('   üìß Cliente: carlos.mendoza@gmail.com');
    console.log('   üìß Distribuidor: contacto@repuestoscentral.cl');
    console.log('   üîë Password (todos): password123');
    console.log('\n‚ú® ¬°Listo para probar todas las funcionalidades!');
    
    process.exit();
  } catch (err) {
    console.error('‚ùå Error al importar datos:', err);
    process.exit(1);
  }
};

// Funci√≥n para eliminar datos
const deleteData = async () => {
  try {
    console.log('üóëÔ∏è Iniciando eliminaci√≥n de datos...');

    console.log('üîÑ Eliminando usuarios...');
    await User.deleteMany();
    console.log('‚úÖ Usuarios eliminados');

    console.log('üîÑ Eliminando categor√≠as...');
    await Category.deleteMany();
    console.log('‚úÖ Categor√≠as eliminadas');

    console.log('üîÑ Eliminando productos...');
    await Product.deleteMany();
    console.log('‚úÖ Productos eliminados');

    console.log('üîÑ Eliminando √≥rdenes...');
    await Order.deleteMany();
    console.log('‚úÖ √ìrdenes eliminadas');

    console.log('üîÑ Eliminando configuraciones del sistema...');
    await SystemConfig.deleteMany();
    console.log('‚úÖ Configuraciones eliminadas');

    console.log('\nüóëÔ∏è Todos los datos han sido eliminados correctamente');
    console.log('üí° Ejecuta "npm run data:import" para restaurar datos de ejemplo');
    
    process.exit();
  } catch (err) {
    console.error('‚ùå Error al eliminar datos:', err);
    process.exit(1);
  }
};

// Funci√≥n para mostrar estad√≠sticas de la base de datos
const showStats = async () => {
  try {
    console.log('üìä ESTAD√çSTICAS DE LA BASE DE DATOS AutoParts');
    console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');

    const userCount = await User.countDocuments();
    const clientCount = await User.countDocuments({ role: 'client' });
    const distributorCount = await User.countDocuments({ role: 'distributor' });
    const adminCount = await User.countDocuments({ role: 'admin' });

    const categoryCount = await Category.countDocuments();
    const productCount = await Product.countDocuments();
    const featuredProductCount = await Product.countDocuments({ featured: true });
    const onSaleProductCount = await Product.countDocuments({ onSale: true });
    const lowStockProductCount = await Product.countDocuments({ stockQuantity: { $lte: 5 } });
    const outOfStockProductCount = await Product.countDocuments({ stockQuantity: 0 });

    const orderCount = await Order.countDocuments();
    const b2cOrderCount = await Order.countDocuments({ orderType: 'B2C' });
    const b2bOrderCount = await Order.countDocuments({ orderType: 'B2B' });
    const completedOrderCount = await Order.countDocuments({ status: 'delivered' });

    const configCount = await SystemConfig.countDocuments();

    console.log('\nüë• USUARIOS:');
    console.log(`   Total: ${userCount}`);
    console.log(`   üîß Administradores: ${adminCount}`);
    console.log(`   üë§ Clientes: ${clientCount}`);
    console.log(`   üè¢ Distribuidores: ${distributorCount}`);

    console.log('\nüìÇ CATEGOR√çAS:');
    console.log(`   Total: ${categoryCount}`);

    console.log('\nüõí PRODUCTOS:');
    console.log(`   Total: ${productCount}`);
    console.log(`   ‚≠ê Destacados: ${featuredProductCount}`);
    console.log(`   üî• En oferta: ${onSaleProductCount}`);
    console.log(`   ‚ö†Ô∏è Stock bajo: ${lowStockProductCount}`);
    console.log(`   üö´ Agotados: ${outOfStockProductCount}`);

    console.log('\nüìã √ìRDENES:');
    console.log(`   Total: ${orderCount}`);
    console.log(`   üõí B2C (Retail): ${b2cOrderCount}`);
    console.log(`   üè¢ B2B (Mayorista): ${b2bOrderCount}`);
    console.log(`   ‚úÖ Completadas: ${completedOrderCount}`);

    console.log('\n‚öôÔ∏è CONFIGURACIONES:');
    console.log(`   Total: ${configCount}`);

    // Mostrar algunos productos destacados
    const featuredProducts = await Product.find({ featured: true }).select('name price onSale discountPercentage stockQuantity').limit(3);
    if (featuredProducts.length > 0) {
      console.log('\nüåü PRODUCTOS DESTACADOS:');
      featuredProducts.forEach(product => {
        const status = product.stockQuantity === 0 ? 'üö´ Agotado' : 
                      product.stockQuantity <= 5 ? '‚ö†Ô∏è Stock bajo' : '‚úÖ Disponible';
        const offer = product.onSale ? ` (${product.discountPercentage}% DESC)` : '';
        console.log(`   ‚Ä¢ ${product.name} - ${product.price.toLocaleString('es-CL')}${offer} - ${status}`);
      });
    }

    // Mostrar distribuidores
    const distributors = await User.find({ role: 'distributor' }).select('name distributorInfo.isApproved distributorInfo.companyName');
    if (distributors.length > 0) {
      console.log('\nüè¢ DISTRIBUIDORES:');
      distributors.forEach(dist => {
        const status = dist.distributorInfo?.isApproved ? '‚úÖ Aprobado' : '‚è≥ Pendiente';
        console.log(`   ‚Ä¢ ${dist.distributorInfo?.companyName || dist.name} - ${status}`);
      });
    }

    console.log('\nüéØ ACCESOS R√ÅPIDOS:');
    console.log('   üìß admin@autoparts.com (Admin)');
    console.log('   üìß carlos.mendoza@gmail.com (Cliente)');
    console.log('   üìß contacto@repuestoscentral.cl (Distribuidor)');
    console.log('   üîë Password: password123 (para todos)');

    process.exit();
  } catch (err) {
    console.error('‚ùå Error al obtener estad√≠sticas:', err);
    process.exit(1);
  }
};

// =====================================================
// üéØ EJECUCI√ìN SEG√öN ARGUMENTOS
// =====================================================

// Verificar argumentos de l√≠nea de comandos
if (process.argv[2] === '-i' || process.argv[2] === '--import') {
  console.log('üöÄ Iniciando importaci√≥n de datos AutoParts...');
  importData();
} else if (process.argv[2] === '-d' || process.argv[2] === '--delete') {
  console.log('üóëÔ∏è Iniciando eliminaci√≥n de datos...');
  deleteData();
} else if (process.argv[2] === '-s' || process.argv[2] === '--stats') {
  console.log('üìä Consultando estad√≠sticas...');
  showStats();
} else {
  console.log('üéØ SEEDER AutoParts - Gestor de Datos de Demostraci√≥n');
  console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
  console.log('');
  console.log('üìã USO: node seeder.js [opci√≥n]');
  console.log('');
  console.log('üîß OPCIONES DISPONIBLES:');
  console.log('   -i, --import    Importar datos de demostraci√≥n');
  console.log('   -d, --delete    Eliminar todos los datos');
  console.log('   -s, --stats     Mostrar estad√≠sticas actuales');
  console.log('');
  console.log('üí° EJEMPLOS:');
  console.log('   npm run data:import    (importar datos)');
  console.log('   npm run data:destroy   (eliminar datos)');
  console.log('   npm run data:stats     (ver estad√≠sticas)');
  console.log('');
  console.log('üéØ FUNCIONALIDADES INCLUIDAS:');
  console.log('   ‚úÖ Sistema de autenticaci√≥n completo');
  console.log('   ‚úÖ Productos con ofertas y descuentos');
  console.log('   ‚úÖ Funcionalidades B2B para distribuidores');
  console.log('   ‚úÖ Gesti√≥n de inventario y stock');
  console.log('   ‚úÖ Sistema de √≥rdenes y pagos');
  console.log('   ‚úÖ Configuraciones del sistema');
  console.log('   ‚úÖ Valoraciones y rese√±as');
  console.log('');
  console.log('üìÖ Datos de ejemplo: Abril-Mayo 2025');
  console.log('üé™ ¬°Perfecto para demostraciones!');
  
  process.exit(1);
}